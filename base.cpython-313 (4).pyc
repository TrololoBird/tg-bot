"""Binance Futures adapter.

This adapter demonstrates how one might wrap Binance's REST API to
provide OHLCV, ticker and open interest data. The current
implementation uses simple stubs because outbound network access is
disabled in this environment. To enable real requests, replace the
``_get`` method with a proper HTTP client (e.g. ``aiohttp``) and
implement parsing of API responses.
"""

from __future__ import annotations

import asyncio
from typing import Any, Dict, List, Optional

from .base import BaseExchangeAdapter


class BinanceFuturesAdapter(BaseExchangeAdapter):
    """Adapter for Binance Futures (USDT‑margined contracts)."""

    BASE_URL = "https://fapi.binance.com"

    def __init__(self) -> None:
        super().__init__(exchange_id="binance")

    async def _get(self, path: str, params: Optional[Dict[str, Any]] = None) -> Any:
        """Placeholder for HTTP GET requests.

        In a production environment this method would perform an
        asynchronous HTTP request to the Binance REST API. Because
        external networking is disabled in this environment, the
        implementation simply returns ``None``. Subclasses or unit
        tests may monkeypatch this method to return canned responses.
        """
        await asyncio.sleep(0)  # yield control
        return None

    async def list_symbols(self) -> List[str]:
        """Return a list of USDT‑margined futures symbols.

        The Binance API endpoint ``/fapi/v1/ticker/24hr`` would normally
        provide volume information for all symbols. Here we return an
        empty list because network access is disabled.
        """
        return []

    async def fetch_ohlcv(self, symbol: str, timeframe: str, limit: int) -> List[List[Any]]:
        """Fetch historical candles for a symbol.

        The Binance Futures API endpoint ``/fapi/v1/klines`` accepts a
        symbol, timeframe and limit. In this stub we return an empty
        list. Tests can override this method to return synthetic data.
        """
        return []

    async def fetch_ticker(self, symbol: str) -> Optional[Dict[str, Any]]:
        """Fetch ticker data for a symbol.

        Returns None in the stub implementation.
        """
        return None

    async def fetch_open_interest_history(self, symbol: str, days: int) -> List[Dict[str, Any]]:
        """Fetch open interest history for a symbol.

        The Binance API endpoint ``/futures/data/openInterestHist`` can
        return open interest in contracts over a specified period. In
        this environment we cannot perform the request, so we return an
        empty list.
        """
        return []